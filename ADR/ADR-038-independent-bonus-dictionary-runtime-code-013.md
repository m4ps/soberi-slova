# ADR-038: Независимый runtime dictionary lookup для bonus-валидации

- Статус: accepted
- Дата: 2026-02-25
- Связанные задачи: [CODE]-[013]

## Контекст

После фикса target-priority (`[CODE]-[014]`) целевые слова уровня засчитывались корректно даже при узком словарном lookup.  
При этом bonus-распознавание в runtime оставалось слабым: `CoreState` по умолчанию использовал ограниченный набор слов `WordValidation`, не синхронизированный с полноценным `data/dictionary.csv`.

Это создавало риск непредсказуемого bonus-поведения и не соответствовало требованию `[CODE]-[013]`: bonus-классификация должна опираться на отдельный словарный индекс и быть независимой от target-набора и генератора уровня.

## Решение

1. Выделить отдельный runtime-слой словаря:
   - добавить `createRuntimeDictionaryResources(csvContent)` в `WordValidation`;
   - строить из CSV два независимых ресурса:
     - `bonusLookupWords` для bonus-классификации;
     - `levelGeneratorEntries` для генерации уровней.
2. Явно прокинуть эти ресурсы в bootstrap:
   - `WordValidation` получает `bonusLookupWords`;
   - `LevelGenerator` получает `levelGeneratorEntries`.
3. Зафиксировать решение тестами:
   - unit на построение runtime-ресурсов;
   - integration на bonus-зачёт при раздельных пулах генерации и валидации.

## Последствия

- Bonus-валидация больше не зависит от target-набора текущего уровня.
- Bonus lookup детерминированно связан с curated CSV словарём, а не с fallback-константами.
- Генерация уровня и bonus-классификация получают общий источник данных (`dictionary.csv`), но остаются раздельными по назначению и wiring.
